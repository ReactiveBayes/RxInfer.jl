<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initialization ¬∑ RxInfer.jl</title><meta name="title" content="Initialization ¬∑ RxInfer.jl"/><meta property="og:title" content="Initialization ¬∑ RxInfer.jl"/><meta property="twitter:title" content="Initialization ¬∑ RxInfer.jl"/><meta name="description" content="Julia package for automated Bayesian inference on a factor graph with reactive message passing"/><meta property="og:description" content="Julia package for automated Bayesian inference on a factor graph with reactive message passing"/><meta property="twitter:description" content="Julia package for automated Bayesian inference on a factor graph with reactive message passing"/><meta property="og:url" content="https://reactivebayes.github.io/RxInfer.jl/manuals/inference/initialization/"/><meta property="twitter:url" content="https://reactivebayes.github.io/RxInfer.jl/manuals/inference/initialization/"/><link rel="canonical" href="https://reactivebayes.github.io/RxInfer.jl/manuals/inference/initialization/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/theme.css" rel="stylesheet" type="text/css"/><link href="../../../assets/header.css" rel="stylesheet" type="text/css"/><script src="../../../assets/header.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="RxInfer.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="RxInfer.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">RxInfer.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../getting-started/">Getting started</a></li><li><a class="tocitem" href="../../comparison/">RxInfer.jl vs. Others</a></li><li><a class="tocitem" href="../../model-specification/">Model specification</a></li><li><a class="tocitem" href="../../constraints-specification/">Constraints specification</a></li><li><a class="tocitem" href="../../meta-specification/">Meta specification</a></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox" checked/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Inference specification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../static/">Static inference</a></li><li><a class="tocitem" href="../streamlined/">Streamline inference</a></li><li class="is-active"><a class="tocitem" href>Initialization</a><ul class="internal"><li><a class="tocitem" href="#Part-1.-Framing-the-problem"><span>Part 1. Framing the problem</span></a></li><li><a class="tocitem" href="#Part-2.-Why-and-What-to-initialize"><span>Part 2. Why and What to initialize</span></a></li><li><a class="tocitem" href="#Implementation-details"><span>Implementation details</span></a></li></ul></li><li><a class="tocitem" href="../autoupdates/">Auto-updates</a></li><li><a class="tocitem" href="../delta-node/">Deterministic nodes</a></li><li><a class="tocitem" href="../nonconjugate/">Non-conjugate inference</a></li><li><a class="tocitem" href="../undefinedrules/">Undefined message update rules</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">Inference customization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../customization/custom-node/">Defining a custom node and rules</a></li><li><a class="tocitem" href="../../customization/postprocess/">Inference results postprocessing</a></li></ul></li><li><a class="tocitem" href="../../debugging/">Debugging</a></li><li><a class="tocitem" href="../../migration-guide-v2-v3/">Migration from v2 to v3</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../../library/model-construction/">Model construction</a></li><li><a class="tocitem" href="../../../library/bethe-free-energy/">Bethe Free Energy</a></li><li><a class="tocitem" href="../../../library/functional-forms/">Functional form constraints</a></li><li><a class="tocitem" href="../../../library/exported-methods/">Exported methods</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Basic examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../examples/basic_examples/overview/">Overview</a></li><li><a class="tocitem" href="../../../examples/basic_examples/Coin Toss Model/">Coin toss model (Beta-Bernoulli)</a></li><li><a class="tocitem" href="../../../examples/basic_examples/Bayesian Linear Regression Tutorial/">Bayesian Linear Regression Tutorial</a></li><li><a class="tocitem" href="../../../examples/basic_examples/Kalman filtering and smoothing/">Kalman filtering and smoothing</a></li><li><a class="tocitem" href="../../../examples/basic_examples/Predicting Bike Rental Demand/">Predicting Bike Rental Demand</a></li><li><a class="tocitem" href="../../../examples/basic_examples/Hidden Markov Model/">How to train your Hidden Markov Model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Advanced examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../examples/advanced_examples/overview/">Overview</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Active Inference Mountain car/">Active Inference Mountain car</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Advanced Tutorial/">Advanced Tutorial</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Assessing People Skills/">Assessing People‚Äôs Skills</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Chance Constraints/">Chance-Constrained Active Inference</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Conjugate-Computational Variational Message Passing/">Conjugate-Computational Variational Message Passing (CVI)</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Global Parameter Optimisation/">Global Parameter Optimisation</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/GP Regression by SSM/">Solve GP regression by SDE</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Infinite Data Stream/">Infinite Data Stream</a></li><li><a class="tocitem" href="../../../examples/advanced_examples/Nonlinear Sensor Fusion/">Nonlinear Sensor Fusion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Problem specific</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../examples/problem_specific/overview/">Overview</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Autoregressive Models/">Autoregressive Models</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Gamma Mixture/">Gamma Mixture Model</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Gaussian Mixture/">Gaussian Mixture</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Hierarchical Gaussian Filter/">Hierarchical Gaussian Filter</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Invertible Neural Network Tutorial/">Invertible neural networks: a tutorial</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Probit Model (EP)/">Probit Model (EP)</a></li><li><a class="tocitem" href="../../../examples/problem_specific/RTS vs BIFM Smoothing/">RTS vs BIFM Smoothing</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Simple Nonlinear Node/">Simple Nonlinear Node</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Universal Mixtures/">Universal Mixtures</a></li><li><a class="tocitem" href="../../../examples/problem_specific/Litter Model/">Litter Model</a></li></ul></li><li><a class="tocitem" href="../../../contributing/examples/">Contribute with examples</a></li></ul></li><li><span class="tocitem">Contributing</span><ul><li><a class="tocitem" href="../../../contributing/guide/">Contribution guide</a></li><li><a class="tocitem" href="../../../contributing/guidelines/">Contribution guidelines</a></li><li><a class="tocitem" href="../../../contributing/new-documentation/">Contributing to the documentation</a></li><li><a class="tocitem" href="../../../contributing/new-example/">Contributing to the examples</a></li><li><a class="tocitem" href="../../../contributing/new-release/">Publishing a new release</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User guide</a></li><li><a class="is-disabled">Inference specification</a></li><li class="is-active"><a href>Initialization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initialization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ReactiveBayes/RxInfer.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ReactiveBayes/RxInfer.jl/blob/main/docs/src/manuals/inference/initialization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="initialization"><a class="docs-heading-anchor" href="#initialization">Understating why we need to initialize posteriors or messages in RxInfer</a><a id="initialization-1"></a><a class="docs-heading-anchor-permalink" href="#initialization" title="Permalink"></a></h1><p>In certain models, after completing the model specification step and moving on to execute the inference procedure, you may encounter an error prompting you to <em>initialize required marginals and messages</em>. Understanding why this step is necessary can be perplexing. This tutorial is designed to explore the intuition behind model initialization using a practical example</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RxInfer.@initialization" href="#RxInfer.@initialization"><code>RxInfer.@initialization</code></a> ‚Äî <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@initialization</code></pre><p>Macro for specifying the initialization state of a model. Accepts either a function or a block of code. Allows the specification of initial messages and marginals that can be applied to a model in the <code>infer</code> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/RxInfer.jl/blob/92db736c8196bc4012028ca6e6eda63f8dc1fd93/src/model/plugins/initialization_plugin.jl#L320-L325">source</a></section></article><p>The syntax for the <code>@initialization</code> macro is similar to the <code>@constraints</code> and <code>@meta</code> macro. An example is shown below:</p><pre><code class="language-julia hljs">using RxInfer

@model function submodel(z, x)
    t := x + 1
    z ~ Normal(mean = t, var = 1.0)
end

@model function mymodel(y)
    x ~ Normal(mean = 0.0, var = 1.0)
    z ~ submodel(x = x)
    y ~ Normal(mean = z, var = 1.0)
end

@initialization begin
    # Initialize the marginal for the variable x
    q(x) = vague(NormalMeanVariance)

    # Initialize the message for the variable z
    Œº(z) = vague(NormalMeanVariance)

    # Specify the initialization for a submodel of type `submodel`
    for init in submodel
        q(t) = vague(NormalMeanVariance)
    end

    # Specify the initialization for a submodel of type `submodel` with a specific index
    for init in (submodel, 1)
        q(t) = vague(NormalMeanVariance)
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Initial state: 
  q(x) = NormalMeanVariance{Float64}(Œº=0.0, v=1.0e12)
  Œº(z) = NormalMeanVariance{Float64}(Œº=0.0, v=1.0e12)
  Init for submodel submodel = 
    q(t) = NormalMeanVariance{Float64}(Œº=0.0, v=1.0e12)

  Init for submodel (submodel, 1) = 
    q(t) = NormalMeanVariance{Float64}(Œº=0.0, v=1.0e12)

</code></pre><p>Similar to the <code>@constraints</code> macro, the <code>@initialization</code> macro also supports function definitions:</p><pre><code class="language-julia hljs">@initialization function my_init()
    # Initialize the marginal for the variable x
    q(x) = vague(NormalMeanVariance)

    # Initialize the message for the variable z
    Œº(z) = vague(NormalMeanVariance)

    # Specify the initialization for a submodel of type `submodel`
    for init in submodel
        q(t) = vague(NormalMeanVariance)
    end

    # Specify the initialization for a submodel of type `submodel` with a specific index
    for init in (submodel, 1)
        q(t) = vague(NormalMeanVariance)
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">my_init (generic function with 1 method)</code></pre><p>The result of the initialization macro can be passed to the <a href="../overview/#RxInfer.infer"><code>infer</code></a> function with a keyword argument called <a href="../overview/#user-guide-inference-execution"><code>initialization</code></a>.</p><h2 id="Part-1.-Framing-the-problem"><a class="docs-heading-anchor" href="#Part-1.-Framing-the-problem">Part 1. Framing the problem</a><a id="Part-1.-Framing-the-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Part-1.-Framing-the-problem" title="Permalink"></a></h2><p>John has recently acquired a new car and is keenly interested in its <code>fuel consumption</code> rate. He holds the belief that this rate follows a linear relationship with the variable <code>speed</code>. To validate this hypothesis, he plans to conduct tests by driving his car on the urban roads close to his home, recording both the <code>fuel consumption</code> and <code>speed</code> data. To ascertain the fuel consumption rate, John has opted for Bayesian linear regression as his analytical method.</p><pre><code class="language-julia hljs">using Random, Plots, StableRNGs

function generate_data(a, b, v, nr_samples; rng = StableRNG(1234))
    x = float.(collect(1:nr_samples))
    y = a .* x .+ b .+ randn(rng, nr_samples) .* sqrt(v)
    return x, y
end;

# For demonstration purposes we generate some fake data
x_data, y_data = generate_data(0.5, 25.0, 1.0, 250)

scatter(x_data, y_data, title = &quot;Dataset (City road)&quot;, legend=false)
xlabel!(&quot;Speed&quot;)
ylabel!(&quot;Fuel consumption&quot;)</code></pre><img src="d3b4b2e7.svg" alt="Example block output"/><h3 id="Univariate-regression-with-known-noise"><a class="docs-heading-anchor" href="#Univariate-regression-with-known-noise">Univariate regression with known noise</a><a id="Univariate-regression-with-known-noise-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-regression-with-known-noise" title="Permalink"></a></h3><p>First, he drives the car on a urban road. John enjoys driving on the well-built, wide, and flat urban roads. Urban roads also offer the advantage of precise fuel consumption measurement with minimal noise. Therefore John models the fuel consumption <span>$y_n\in\mathbb{R}$</span> as a normal distribution and treats <span>$x_n$</span> as a fixed hyperparameter:</p><p class="math-container">\[\begin{aligned}
p(y_n \mid a, b) = \mathcal{N}(y_n \mid a x_n + b , 1)
\end{aligned}\]</p><p>The recorded speed is denoted as <span>$x_n \in \mathbb{R}$</span> and the recorded fuel consumption as <span>$y_n \in \mathbb{R}$</span>. Prior beliefs on <span>$a$</span> and <span>$b$</span> are informed by the vehicle manual.</p><p class="math-container">\[\begin{aligned}
    p(a) &amp;= \mathcal{N}(a \mid m_a, v_a) \\
    p(b) &amp;= \mathcal{N}(b \mid m_b, v_b) 
\end{aligned}\]</p><p>Together they form the probabilistic model <span>$p(y, a, b) = p(a)p(b) \prod_{N=1}^N p(y_n \mid a, b),$</span> where the goal is to infer the posterior distributions <span>$p(a \mid y)$</span> and <span>$p(b\mid y)$</span>.</p><p>In order to estimate the two parameters with the recorded data, he uses a <code>RxInfer.jl</code> to create the above described model.</p><pre><code class="language-julia hljs">using RxInfer

@model function linear_regression(y, x)
    a  ~ Normal(mean = 0.0, variance = 1.0)
    b  ~ Normal(mean = 0.0, variance = 100.0)
    y .~ Normal(mean = a .* x .+ b, variance = 1.0)
end</code></pre><p>Delighted with the convenience offered by the package&#39;s inference function (<a href="../overview/#RxInfer.infer"><code>infer</code></a>), he appreciates the time saved from building everything from the ground up. This feature allows him to effortlessly obtain the desired results for his specific road. Upon consulting the documentation, he proceeds to run the inference function.</p><pre><code class="language-julia hljs">results = infer(
    model        = linear_regression(), 
    data         = (y = y_data, x = x_data), 
    returnvars   = (a = KeepLast(), b = KeepLast()),
    iterations   = 20,
    free_energy  = true
)</code></pre><p>Oeps! Exception?</p><pre><code class="nohighlight hljs">exception =
‚îÇ    Variables [ a, b ] have not been updated after an update event. 
‚îÇ    Therefore, make sure to initialize all required marginals and messages. See `initialization` keyword argument for the inference function. 
‚îÇ    See the function documentation for detailed information regarding the initialization.</code></pre><p>After running the inference procedure an error appears, which prompts him to <em>initialize all required messages and marginals</em>. Now, John is left pondering the reason behind this requirement. Why is it necessary? Should he indeed initialize all messages and marginals? And if so, how might this impact the inference procedure?</p><h2 id="Part-2.-Why-and-What-to-initialize"><a class="docs-heading-anchor" href="#Part-2.-Why-and-What-to-initialize">Part 2. Why and What to initialize</a><a id="Part-2.-Why-and-What-to-initialize-1"></a><a class="docs-heading-anchor-permalink" href="#Part-2.-Why-and-What-to-initialize" title="Permalink"></a></h2><p>Before delving too deeply into the details, it&#39;s important to understand that RxInfer constructs a factorized representation of your model using a factor graph. In this structure, inference is executed through message passing.</p><p>A challenge arises when RxInfer generates the FFG representation with structural loops in certain parts of the graph. These loops indicate that a message or marginal within the loop depends not only on its prior but also on itself. Consequently, proper initialization is crucial for initiating the inference process. Two general rules of thumb guide this initialization, although the intricate details are beyond the scope of this tutorial:</p><p>1.	Initiate as few messages/marginals as possible when dealing with a loop structure, it will be more efficient and accurate. 2.	Prioritize initializing marginals over messages.</p><p><strong>How to identify and handle the loops?</strong></p><p>Identifying loops is currently a manual process, as the current version of RxInfer doesn&#39;t support a graphical representation of the created graph. As such, the manual process involves:</p><p>1.	Deriving the graphical representation of the model, 2.	Identifying loops and the messages or marginals that need to be initialized within the loop.</p><p>However, once you receive the message <code>Variables [x, y, z] have not been updated after an update event</code>, it is a good indication that there is a loop in your model. If you see this message, you should check your model for loops and try to initialize the messages and/or marginals that are part of the loop.</p><h3 id="Deriving-factor-graph-and-identifying-the-loops"><a class="docs-heading-anchor" href="#Deriving-factor-graph-and-identifying-the-loops">Deriving factor graph and identifying the loops</a><a id="Deriving-factor-graph-and-identifying-the-loops-1"></a><a class="docs-heading-anchor-permalink" href="#Deriving-factor-graph-and-identifying-the-loops" title="Permalink"></a></h3><p>John proceeds to derive the factor graph for his problem where he identifies where the loops are:</p><p><img src="../../../assets/img/linear_regresion_model.png" alt="Addons_messages"/></p><p>He does note that there is a loop in his model, namely all <span>$a$</span> and <span>$b$</span> variables are connected over all observations, therefore he needs to initialize one of the messages and run multiple iterations for the loopy belief propagation algorithm. It is worth noting that loopy belief propagation is not guaranteed to converge in general and might be highly influenced by the choice of the initial messages in the <code>initialization</code> argument. He is going to evaluate the convergency performance of the algorithm with the <code>free_energy = true</code> option:</p><pre><code class="language-julia hljs">init = @initialization begin
    Œº(b) = NormalMeanVariance(0.0, 100.0)
end

results = infer(
    model           = linear_regression(),
    data            = (y = y_data, x = x_data),
    initialization  = init,
    returnvars      = (a = KeepLast(), b = KeepLast()),
    iterations      = 20,
    free_energy     = true
)

# drop first iteration, which is influenced by the `initmessages`
plot(2:20, results.free_energy[2:end], title=&quot;Free energy&quot;, xlabel=&quot;Iteration&quot;, ylabel=&quot;Free energy [nats]&quot;, legend=false)</code></pre><img src="f86cb61a.svg" alt="Example block output"/><p>Now the inference runs without the error! üéâ</p><pre><code class="language-julia hljs">as = rand(results.posteriors[:a], 100)
bs = rand(results.posteriors[:b], 100)
p = scatter(x_data, y_data, title = &quot;Linear regression with more noise&quot;, legend=false)
xlabel!(&quot;Speed&quot;)
ylabel!(&quot;Fuel consumption&quot;)
for (a, b) in zip(as, bs)
    global p = plot!(p, x_data, a .* x_data .+ b, alpha = 0.05, color = :red)
end
plot(p, size = (900, 400))</code></pre><img src="9b2227bf.svg" alt="Example block output"/><h2 id="Implementation-details"><a class="docs-heading-anchor" href="#Implementation-details">Implementation details</a><a id="Implementation-details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-details" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RxInfer.InitializationPlugin" href="#RxInfer.InitializationPlugin"><code>RxInfer.InitializationPlugin</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MetaPlugin(init)</code></pre><p>A plugin that adds a init information to the factor nodes of the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/RxInfer.jl/blob/92db736c8196bc4012028ca6e6eda63f8dc1fd93/src/model/plugins/initialization_plugin.jl#L171-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RxInfer.convert_init_object" href="#RxInfer.convert_init_object"><code>RxInfer.convert_init_object</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert_init_object(e::Expr)</code></pre><p>Converts a variable init or a factor init call on the left hand side of a init specification to a <code>GraphPPL.MetaObject</code>.</p><p><strong>Arguments</strong></p><ul><li><code>e::Expr</code>: The expression to convert.</li></ul><p><strong>Returns</strong></p><ul><li><code>Expr</code>: The resulting expression with the variable reference or factor function call converted to a <code>GraphPPL.MetaObject</code>.</li></ul><p><strong>Examples</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ReactiveBayes/RxInfer.jl/blob/92db736c8196bc4012028ca6e6eda63f8dc1fd93/src/model/plugins/initialization_plugin.jl#L281-L293">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../streamlined/">¬´ Streamline inference</a><a class="docs-footer-nextpage" href="../autoupdates/">Auto-updates ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Created in <a href="https://biaslab.github.io/">BIASlab</a>, maintained by <a href="https://github.com/ReactiveBayes">ReactiveBayes</a>, powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 8 December 2024 15:09">Sunday 8 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
